---
title: "Analysing Cookie Cats"
author: "Eduard Corral, Marcel Feliu and Paula Ros."
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## 1. Getting to know the datasets

Before we start with the analysis, have a look at the structure of both datasets. First, upload the data sets in
R. For a smoother correction on my side, please provide the data frames with the following names:
• For dataset ‘cookie_cats_ABtest.csv‘ use data frame variable named ‘DS‘.
• For dataset ‘cookie_cats_purch.csv", use data frame variable named ‘PR‘.
For each dataset, show and describe the information that they contain: rows and columns of the dataset, and
types of variables.

```{r getting to know the datasets}
  DS <- read.csv("cookie_cats_ABtest.csv", sep = ",")
  PR <- read.csv("cookie_cats_purch.csv", sep = ",")
  
  str(DS)
  str(PR)
```

## 2. Preprocessing

Before we start with the analysis, revise the structure and contents of the data sets to look for inconsistencies,
missing values, or errors, and if necessary, perform the necessary transformations. You should also check that
all IDs of the second data set (cookie_cats_purch) are valid IDs (i.e., existing IDs in cookie_cats_ABtest).
If you apply any transformation, you should include a proper explanation in your report.

### 2.1. Preprocessing dataset “Cookie Cats AB Testing”

First of all, we used the function is.na() to locate the rows that had NA and then, we deleted them.

```{r preprocessing part 1 Cookie Cats AB Testing}
  naUserid <- which(is.na(DS$userid)) ; naUserid
  DS <- DS[-naUserid, ]
```
After that, we used the function table() to look at the different variables to discover any more inconsistencies. We discovered that the variable called "retention_1" had two versions of TRUE and two versions of FALSE,
ones with lowercase letters and spaces and the others correct, with capital letters. The following code shows the process on preprocessing the content of this variable.

```{r preprocessing part 2 Cookie Cats AB Testing}
  table(DS$retention_1)
  DS$retention_1[DS$retention_1 == "false "] = FALSE
  DS$retention_1[DS$retention_1 == "  true "] = TRUE
  table(DS$retention_1)
```

### 2.2. Preprocessing dataset “Cookie Cats Purchases”

For the "Cookie Cats Purchases" dataset we discovered that the NA from the previous dataset were included too in this one. We obtained the positions of this variables and deleted their rows.

```{r preprocessing Cookie Cats Purchases}
  inexistentValues <- which((PR$id %in% DS$userid) == FALSE) ; inexistentValues
  PR <- PR[-inexistentValues, ]
  which((PR$id %in% DS$userid) == FALSE)
```

## 3. Descriptive Analytics

Perform descriptive analytics of the datasets visually and numerically. To make this task simpler, we’ll do
the analysis for each data set separately.
```{r Descriptive Analytics}
#install.packages("pastecs")
#library(pastecs)
#stat.desc(PR)
#stat.desc(DS)

#merge
#library(dplyr)
#usersDownload<-merge(DS,PR,by.x="userid",by.y="id")
#unique(usersDownload$userid)

```

### 3.1. Dataset “Cookie Cats AB Testing”
#### 3.1.1 Users that downloaded the game
There are 90.186 users that downloaded the Cookie Cats game.
```{r Users that downloaded the games}
  nrow(DS)
```
#### 3.1.2 Distribution of users in groups
From the 90.186 users, 44699 played the gate number 30 and 45.487 played the gate number 40.
```{r Distribution of users in groups}
table(DS$version)
```

#### 3.1.3 Game rounds
What is the distribution of game rounds in the players’ population? And among the users of version A
and version B of the game separately
```{r Game rounds}
boxplot(DS$sum_gamerounds)
```
#### 3.1.4 Retention (day 1 and day 7)

```{r retention}
  # usersDowload[usersDownload$userid,usersDownload$retention1,usersDownload$retention_7]
```

#### 3.1.5 Are there non-playing users?
```{r no player users}

#noPlayers <-length(DS$userid[DS$sum_gamerounds ==0])
#gamers <- length(PR$id) - noPlayer
#totalPl<- c(noPlayers,gamers)
#pie(totalPl)

```

### 3.2 Dataset “Cookie Cats Purchases”

## 4. Monetization metrics

## 5. A/B testing
### 5.1 Hypotheses
### 5.2 Visualisation
### 5.3 Computation
### 5.4 Conclusion of A/B testing

## 6. Regression analysis
### 6.1 Visual representation
### 6.2 Building the model
### 6.3 Model fit
### 6.4 Predict a case
### 6.5 Simulation

## 7. Dashboard

## 8. Conclusion

## 9. Team contribution

## 10. Non-cheating manifesto

